
# strategies/donchian_long.yaml
# Example Donchian breakout (LONG) with volume confirmation.
strategy:
  name: donchian_long
  side: LONG
  timeframes: ["5m", "15m", "1h"]

  entry:
    all:
      - name: "donch_break"
        indicator: "donchian_break"
        timeframe: "5m"
        params: { length: 20 }
        op: "is_true"
      - name: "volume_confirm"
        indicator: "volume_ratio"
        timeframe: "5m"
        params: { lookback: 20 }
        op: ">="
        value: 1.5
      - name: "trend_filter"
        indicator: "ema_cross"
        timeframe: "1h"
        params: { fast: 50, slow: 200, direction: "above" }
        op: "is_true"

  veto:
    any:
      - name: "RSI_OVERBOUGHT"
        indicator: "rsi"
        timeframe: "1h"
        params: { period: 14 }
        op: ">="
        value: 85

  sizing:
    base_risk_usdt: 20
    scalers:
      - { name: "winprob", source: "context", key: "winprob",
          method: "piecewise",
          pieces: [ {lt: 0.55, factor: 0.7}, {lt: 0.7, factor: 1.0}, {ge: 0.7, factor: 1.5} ],
          default: 1.0 }

  exits:
    sl: { type: "atr", timeframe: "1h", mult: 1.8 }
    tp:
      - { type: "atr", mult: 2.5, size_pct: 60 }
      - { type: "atr", mult: 4.0, size_pct: 40 }
    time_exit_hours: 6
