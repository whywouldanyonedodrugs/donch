# Strategy selection
STRATEGY_SPEC_PATH: "strategies/donch_pullback_long.yaml"

# Sizing
RISK_MODE: "fixed"          # or "percent"
RISK_USD: 50.0              # temporary canary base risk (USDT)
FIXED_RISK_CASH: 50.0       # alias used by parity handovers
RISK_USD_MAX: 100.0         # legacy safety knob; parity sizing path uses notional cap
RISK_EQUITY_PCT: 0.01       # used if RISK_MODE="percent"
RISK_PCT: 0.01              # alias used by parity handovers
NOTIONAL_CAP_PCT_OF_EQUITY: 1.0
MAX_LEVERAGE: 10.0
MIN_TRADE_AUTOPAD_ENABLED: false
MIN_TRADE_AUTOPAD_CAP_USD: 5.0

# Exits: SL/TP via ATR(1h)
SL_ATR_MULT: 2.0
FINAL_TP_ENABLED: true
PARTIAL_TP_ENABLED: false   # per spec: no partials
TRAIL_DISTANCE_ATR_MULT: 0.0  # trailing OFF
TIME_EXIT_HOURS_ENABLED: true
TIME_EXIT_HOURS: 72

# Throughput
SYMBOL_COOLDOWN_HOURS: 4
SCAN_INTERVAL_SEC: 60

DEDUP_WINDOW_HOURS: 2

# where you scpâ€™d the artifact
META_EXPORT_DIR: "/root/apps/donch/results/meta_export_pstar_042"
WINPROB_MODEL_DIR: "/root/apps/donch/results/meta_export_pstar_042"
WINPROB_ARTIFACT_DIR: "/root/apps/donch/results/meta_export_pstar_042"

# live gate; can be tuned without re-exporting the model
# Legacy key (kept for compatibility; live parity path ignores it)
MIN_WINPROB_TO_TRADE: null
ETH_BAROMETER_ENABLED: false       # parity: no separate ETH sizing resize path in live
REGIME_BLOCK_WHEN_DOWN: false       # let entries through while testing
REGIME_SIZE_WHEN_DOWN: 0.2
BT_META_REPLAY_ENABLED: false       # temporary: no replay path while waiting for new bundle
# optional sizing-by-prob (already supported in your bot)
WINPROB_SIZING_ENABLED: true
WINPROB_MIN_MULTIPLIER: 0.80
WINPROB_MAX_MULTIPLIER: 1.60
WINPROB_PROB_FLOOR: 0.42
WINPROB_PROB_CAP: 0.90
META_SIZING_P0: 0.42
META_SIZING_P1: 0.90
META_SIZING_MIN: 1.00
META_SIZING_MAX: 2.00
VWAP_STACK_SIZING_ENABLED: false    # temporary: keep sizing chain parity-focused


UNIVERSE_CTX_REFRESH_MIN: 1440 
DEBUG_SIGNAL_DIAG: true


UNIVERSE_CACHE_ENABLED: true
UNIVERSE_CACHE_TTL_MIN: 1440        # rebuild after 24h (tweak as you like)
UNIVERSE_CACHE_PATH: "universe_cache.json"
UNIVERSE_CACHE_REQUIRE_SYMBOLS_MATCH: true

DEBUG_SIGNAL_DIAG: true
DEBUG_SCORE_META_ON_REJECT: true


RS_MIN_PERCENTILE: 70
LIQ_MIN_24H_USD: 500000
DON_N_DAYS: 20





# correlation guard
CORR_GUARD_ENABLED: false
CORR_TIMEFRAME: "1h"
CORR_LOOKBACK_BARS: 500
CORR_METHOD: "spearman"
CORR_MAX_AVG: 0.90

# correlation sizing (optional)
CORR_SIZING_ENABLED: false
CORR_SIZING_RHO_LO: 0.60
CORR_SIZING_RHO_HI: 0.90
CORR_SIZING_LO: 0.70
CORR_SIZING_HI: 1.00




# --- OI & Funding feature pack (meta-model parity) ---
OI_FUNDING_FEATURES_ENABLED: true
OI_TIMEFRAME: "5m"                 # 5m base grid
OI_LOOKBACK_DAYS: 7                # to compute 7d z-scores
FUNDING_LOOKBACK_DAYS: 7           # forward-filled to 5m
FUNDING_UPSAMPLE_TO_5M: true       # keep on by default (matches training)
META_REQUIRED: true                # (optional) fail-closed on feature mismatch

META_SCHEMA_DIAG_SYMBOLS: "BTCUSDT,ETHUSDT"

REGIMES_REPORT_PATH: "/root/apps/donch/results/meta_export_pstar_042/regimes_report.json"

GOV_CTX_DAYS_5M: 90
VOL_CAP_BARS: 15000



# Meta gating
META_PROB_GATE_ENABLED: false          # Option 1 = false
META_PROB_THRESHOLD: 0.42              # enforce bundle-selected decision threshold
META_GATE_SCOPE: "all"                 # scope=ALL policy from export
META_GATE_FAIL_CLOSED: false           # scope is disabled for ALL, kept explicit

# Meta sizing
META_SIZING_ENABLED: true
RISK_OFF_PROBE_MULT: 0.25
DYN_MACD_HIST_THRESH: 0.0
REGIME_DOWNSIZE_MULT: 1.0
BTC_VOL_HI: 0.753777980804443
META_SIZING_CURVE_PATH: null          # artifact retained; strict parity sizing path does not use curve-first mapping
META_SIZING_FAIL_CLOSED: true         # if curve missing/invalid: do not upsize; cap to probe

# OHLCV caching
OHLCV_DISK_CACHE_ENABLED: true
OHLCV_DISK_CACHE_SQLITE: "results/runtime/ohlcv_cache.sqlite"
OHLCV_DISK_CACHE_TFS: ["5m"]
OHLCV_DISK_FLUSH_BARS: 12
OHLCV_DISK_KEEP_BARS: 20000
OHLCV_DISK_LOAD_BARS: 15000
OHLCV_PAGE_LIMIT_LOW_TF_MAX: 1000
API_SEM_ACQUIRE_TIMEOUT_S: 30
